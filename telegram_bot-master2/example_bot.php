<?php

require_once("lib/telegram_bot.php");

class TestBot extends TelegramBot{
    protected $token = "5245759628:AAEVpSjWbdXwKmVxMCxVeD4cF2WhNRu5WZQ";
    protected $bot_name = "@Yak_tu_bot";
    //public $proxy = "tcp://88.99.181.138:8080";


    /**
     * ÐŸÑ€ÐµÐ´ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ñ‹ ÐºÐ¾Ð¼Ð°Ð½Ð´
     * ÐºÐ¾Ð¼Ð°Ð½Ð´Ð° => Ð¼ÐµÑ‚Ð¾Ð´ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹
     */

    protected $commands = [
        "/start" => "cmd_start",
        "/help" => "cmd_help",
        "ÐŸÑ€Ð¾Ñ”ÐºÑ‚" => "cmd_aboutproject",
        "ÐœÐ¾Ñ—_Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ—" => "cmd_istorii",
        "Ð¯Ðº" => "cmd_howwork",
        "ÐŸÑ€Ð°Ð²Ð¸Ð»Ð°" => "cmd_pravila",
        "Ð§Ð¸Ñ‚Ð°Ñ‚Ð¸" => "cmd_readhistory",
        "ÐŸÐ¾Ð´Ñ–Ð»Ð¸Ñ‚Ð¸ÑÑ" => "cmd_podilutus"
    ];

    /**
     * ÐŸÑ€ÐµÐ´ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ ÐºÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€Ñ‹
     *
     * Ð¡Ð¿Ñ€Ð°Ð²ÐºÐ° Ð¿Ð¾ ÐºÐ»Ð°Ð²Ð¸Ñ‚ÑƒÑ€Ð°Ð¼: https://core.telegram.org/bots/api#replykeyboardmarkup
     *
     */

    public $keyboards = [
        'default' => [
            'keyboard' => [
                ["ÐŸÑ€Ð¾Ñ”ÐºÑ‚", "ÐœÐ¾Ñ—_Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ—"], // Ð”Ð²Ðµ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð² Ñ€ÑÐ´
                ["Ð¯Ðº Ñ†Ðµ Ð¿Ñ€Ð°Ñ†ÑŽÑ”?","ÐŸÑ€Ð°Ð²Ð¸Ð»Ð°"],
                //["ÐœÑƒÐ·Ñ‹ÐºÐ°", "ÐŸÐ¾Ð´ÐºÐ°ÑÑ‚"],
                ["Ð§Ð¸Ñ‚Ð°Ñ‚Ð¸ Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ—","ÐŸÐ¾Ð´Ñ–Ð»Ð¸Ñ‚Ð¸ÑÑ Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ”ÑŽ"] // ÐšÐ½Ð¾Ð¿ÐºÐ° Ð½Ð° Ð²ÑÑŽ ÑˆÐ¸Ñ€Ð¸Ð½Ñƒ
            ]
        ],
        'inline1' => [
            // Ð”Ð²Ðµ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð² Ñ€ÑÐ´
            [
                // Ð²Ñ‹Ð·Ð¾Ð²ÐµÑ‚ Ð¼ÐµÑ‚Ð¾Ð´ callback_act1(),
                [
                    'text' => "â„¹ï¸ Ð’Ñ–Ð´Ð¿Ñ€Ð°Ð²Ð¸Ñ‚Ð¸",
                    'callback_data'=> "act1"
                ],
                [
                    'text' => "ðŸ”— Ð ÐµÐ´Ð°Ð³ÑƒÐ²Ð°Ñ‚Ð¸",
                    'callback_data'=> "act2 param1 param2"
                ],


                // Ð²Ñ‹Ð·Ð¾Ð²ÐµÑ‚ Ð¼ÐµÑ‚Ð¾Ð´ callback_act2(),
                // Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð±ÑƒÐ´ÑƒÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ $this->result['callback_query']["data"]

            ],
            [
                ['text' => "ðŸšª ÐŸÐ¾Ð²ÐµÑ€Ð½ÑƒÑ‚Ð¸ÑÑŒ", 'callback_data'=> "logout"],
            ]


        ],

        'inline' => [
            // Ð”Ð²Ðµ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð² Ñ€ÑÐ´
            [
                // Ð²Ñ‹Ð·Ð¾Ð²ÐµÑ‚ Ð¼ÐµÑ‚Ð¾Ð´ callback_act1(),
                [
                    'text' => "â„¹ï¸ ÐŸÐ¾Ð´Ñ–Ð»Ð¸Ñ‚Ð¸ÑÑ Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ”ÑŽ",
                    'callback_data'=> "act1"
                ],
                [
                    'text' => "ðŸšª Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ", 'callback_data'=> "logout"
                ]

                // Ð²Ñ‹Ð·Ð¾Ð²ÐµÑ‚ Ð¼ÐµÑ‚Ð¾Ð´ callback_act2(),
                // Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð±ÑƒÐ´ÑƒÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ $this->result['callback_query']["data"]
               /* [
                    'text' => "ðŸ”— C Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð°Ð¼Ð¸",
                    'callback_data'=> "act2 param1 param2"
                ]*/
            ],
            /*[
                ['text' => "ðŸŒŽ Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ 3", 'callback_data'=> "act3"],
                ['text' => "ðŸ“š Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ 4", 'callback_data'=> "act4"]
            ],*/
            // ÐšÐ½Ð¾Ð¿ÐºÐ° Ð½Ð° Ð²ÑÑŽ ÑˆÐ¸Ñ€Ð¸Ð½Ñƒ
            /*[
                ['text' => "ðŸšª Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ", 'callback_data'=> "logout"],
            ]*/
        ],
        'back' =>[[['text' => "â†© ÐÐ°Ð·Ð°Ð´", 'callback_data'=> "back"]]],
        'close' =>[[['text' => "ðŸšª Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ", 'callback_data'=> "logout"]]],
    ];

    /**
     * ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð²Ð²Ð¾Ð´Ð° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ "/start"
     */
    function cmd_start(){
        $this->api->sendMessage([
            'text' => "ÐŸÑ€Ð¸Ð²Ñ–Ñ‚!
Ð¢Ð°Ðº, Ð·Ð°Ñ€Ð°Ð· Ð²Ñ–Ð¹Ð½Ð°. Ð† ÐºÐ¾Ð¶ÐµÐ½ Ð· Ð½Ð°Ñ Ð²Ð¶Ðµ Ð¼Ð°Ñ” ÑÐ²Ñ–Ð¹ Ð²Ð»Ð°ÑÐ½Ð¸Ð¹ Ð´Ð¾ÑÐ²Ñ–Ð´ Ð¶Ð¸Ñ‚Ñ‚Ñ Ð¿Ñ–Ð´ Ñ‡Ð°Ñ Ð²Ñ–Ð¹Ð½Ð¸.
Ð¦ÐµÐ¹ Ð±Ð¾Ñ‚ Ð·Ð±Ð¸Ñ€Ð°Ñ” Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ— ÑƒÐºÑ€Ð°Ñ—Ð½Ñ†Ñ–Ð².
Ð†ÑÑ‚Ð¾Ñ€Ñ–Ñ— Ð¿Ñ€Ð¾ Ð±Ñ–Ð»ÑŒ Ñ‚Ð° ÑÐ»ÑŒÐ¾Ð·Ð¸, Ð¿Ñ€Ð¾ ÑƒÑÐ²Ñ–Ð´Ð¾Ð¼Ð»ÐµÐ½Ð½Ñ Ñ‚Ð° Ð¼Ñ€Ñ–Ñ—, Ð¿Ñ€Ð¾ Ð²Ñ‚Ñ€Ð°Ñ‚Ð¸ Ñ‚Ð° Ð·Ð½Ð°Ñ…Ñ–Ð´ÐºÐ¸, Ð¿Ñ€Ð¾ Ð»ÑŽÐ±Ð¾Ð² Ñ‚Ð° Ð½Ð°Ð´Ñ–ÑŽ.
Ð Ð¾Ð·ÐºÐ°Ð¶Ð¸, Ñ‰Ð¾ Ñ‚Ð¾Ð±Ñ– Ð´Ð¾Ð²ÐµÐ»Ð¾ÑÑŒ Ð¿ÐµÑ€ÐµÐ¶Ð¸Ñ‚Ð¸, Ñ‡Ð¾Ð¼Ñƒ Ñ‚ÐµÐ±Ðµ Ð½Ð°Ð²Ñ‡Ð¸Ð»Ð° Ð²Ñ–Ð¹Ð½Ð°, ÑÐºÐ¸Ð¹ ÐµÐ¿Ñ–Ð·Ð¾Ð´ Ð²Ñ€Ð°Ð·Ð¸Ð² Ð½Ð°Ð¹Ð±Ñ–Ð»ÑŒÑˆÐµ. ÐÐ±Ð¾ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ñ€Ð¾Ð·ÐºÐ°Ð¶Ð¸ ÑÐº Ñ‚Ð¸.

ÐÐ°ÑˆÑ– Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ— - Ñ†Ðµ Ð½Ð°ÑˆÐ° Ð¿Ð°Ð¼â€™ÑÑ‚ÑŒ, Ð½Ð°ÑˆÐ° Ð¿Ñ–Ð´Ñ‚Ñ€Ð¸Ð¼ÐºÐ°. Ð¦Ðµ ÑÐ¸Ð»Ð°, ÑÐºÐ° Ð½Ð°Ñ Ð¿Ð¾Ñ”Ð´Ð½ÑƒÑ” Ñ‚Ð° Ð·Ð°Ð¿ÐµÐ²Ð½ÑÑ”, Ñ‰Ð¾ Ð¼Ð¸ Ð²Ð¸ÑÑ‚Ð¾Ñ—Ð¼Ð¾ Ð¿Ð¾Ð¿Ñ€Ð¸ Ð²ÑÐµ.


ÐŸÐµÑ€ÐµÐ³Ð»ÑÐ½ÑƒÑ‚Ð¸ Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ—  ðŸŒŽ https://t.me/Yak_ty",
            'reply_markup' => json_encode($this->keyboards['default'])
        ]);

    }

    /**
     * ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð²Ð²Ð¾Ð´Ð° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ "ÐŸÑ€Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚"
     */
    function cmd_aboutproject()
    {
        $this->api->sendMessage([
            'text' => "Â«Ð¯Ðº Ñ‚Ð¸?Â» â€“ Ð¿Ð¸Ñ‚Ð°Ð½Ð½Ñ, ÑÐºÐµ ÑÑ‚Ð°Ð»Ð¾ Ð¾ÑÐ¾Ð±Ð»Ð¸Ð²Ð¸Ð¼ Ð¿Ñ–Ð´ Ñ‡Ð°Ñ Ð²Ñ–Ð¹Ð½Ð¸. ÐŸÑ–Ð´ Ñ‡Ð°Ñ, ÐºÐ¾Ð»Ð¸ ÐºÐ¾Ð¶ÐµÐ½ ÑƒÐºÑ€Ð°Ñ—Ð½ÐµÑ†ÑŒ Ð¾Ñ‚Ñ€Ð¸Ð¼ÑƒÑ” ÑÑ‚Ñ€Ð°ÑˆÐ½Ð¸Ð¹ Ð´Ð¾ÑÐ²Ñ–Ð´. ÐÐ»Ðµ Ñ†ÐµÐ¹ Ð´Ð¾ÑÐ²Ñ–Ð´ Ð²Ñ–Ð´ÐºÑ€Ð¸Ð²Ð°Ñ” Ð² Ð½Ð°Ñ ÑÐ¸Ð»Ð¸, Ð¿Ñ€Ð¾ ÑÐºÑ– Ð¼Ð¸ Ð½Ñ–ÐºÐ¾Ð»Ð¸ Ð½Ðµ Ð·Ð½Ð°Ð»Ð¸.
            
ÐšÐ¾Ð¶ÐµÐ½ Ð· Ð½Ð°Ñ Ð²Ð¶Ðµ Ð¼Ð°Ñ” ÑÐ²Ð¾ÑŽ Ñ–ÑÑ‚Ð¾Ñ€Ñ–ÑŽ Ñ†Ñ–Ñ”Ñ— Ð²Ñ–Ð¹Ð½Ð¸: Ð¿Ñ€Ð¾ Ð²Ñ–Ð´Ñ‡Ð°Ð¹ Ñ‚Ð° Ð³ÐµÑ€Ð¾Ñ—Ð·Ð¼, Ð¿Ñ€Ð¾ Ñ€Ð¾Ð·Ð¿Ð°Ñ‡ Ñ‚Ð° Ð½Ð°Ð´Ñ–ÑŽ, Ð¿Ñ€Ð¾ ÑÑ‚Ñ€Ð°Ñ…Ð¸ Ñ‚Ð° Ð²Ð¸ÐºÐ»Ð¸ÐºÐ¸. Ð Ð¾Ð·ÐºÐ°Ð¶Ñ–Ñ‚ÑŒ Ñ–ÑÑ‚Ð¾Ñ€Ñ–ÑŽ Ð²Ð°ÑˆÐ¾Ñ— ÑÐ¸Ð»Ð¸, Ð¿Ð¾Ð´Ñ–Ð»Ñ–Ñ‚ÑŒÑÑ ÑÐ²Ð¾Ñ—Ð¼ Ð´Ð¾ÑÐ²Ñ–Ð´Ð¾Ð¼: Ñ‡ÐµÑ€ÐµÐ· Ñ‰Ð¾ Ð²Ð¸ Ð·Ð¼Ð¾Ð³Ð»Ð¸ Ð¿Ñ€Ð¾Ð¹Ñ‚Ð¸? ÐÐ° Ñ‰Ð¾ Ð²Ð¸ Ð²Ð¸ÑÐ²Ð¸Ð»Ð¸ÑÑŒ ÑÐ¿Ñ€Ð¾Ð¼Ð¾Ð¶Ð½Ð¸Ð¼? Ð’Ñ–Ð´ Ñ‡Ð¾Ð³Ð¾ Ð±Ð¾Ð»Ð¸Ñ‚ÑŒ ÑÐ°Ð¼Ðµ Ð·Ð°Ñ€Ð°Ð·?

Ð’Ð°ÑˆÐ° Ñ€Ð¾Ð·Ð¿Ð¾Ð²Ñ–Ð´ÑŒ â€“ Ñ†Ðµ Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ Ð²Ð°ÑˆÐ¾Ñ— ÑÐ¸Ð»Ð¸, Ñ†Ðµ Ð´Ð¾ÐºÐ°Ð· Ñ‚Ð¾Ð³Ð¾, Ñ‰Ð¾ ÑƒÐºÑ€Ð°Ñ—Ð½Ñ†Ñ– Ð·Ð´Ð°Ñ‚Ð½Ñ– Ð²Ð¸ÑÑ‚Ð¾ÑÑ‚Ð¸ Ð¿Ð¾Ð¿Ñ€Ð¸ Ð²ÑÐµ. Ð† Ð¿ÐµÑ€ÐµÐ¼Ð¾Ð³Ñ‚Ð¸!

Ð† Ð¿Ð°Ð¼â€™ÑÑ‚Ð°Ð¹Ñ‚Ðµ, Ð½Ðµ Ñ–ÑÐ½ÑƒÑ” Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ¸Ñ… Ð°Ð±Ð¾ Ð½ÐµÐ²Ð°Ð¶Ð»Ð¸Ð²Ð¸Ñ… Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ð¹. ÐšÐ¾Ð¶Ð½Ð° Ñ€Ð¾Ð·Ð¿Ð¾Ð²Ñ–Ð´ÑŒ Ñ„Ð¾Ñ€Ð¼ÑƒÑ” ÑÐºÐ°Ñ€Ð±Ð½Ð¸Ñ†ÑŽ ÑƒÐºÑ€Ð°Ñ—Ð½ÑÑŒÐºÐ¾Ñ— Ð¼ÑƒÐ¶Ð½Ð¾ÑÑ‚Ñ–.

ÐŸÐµÑ€ÐµÐ³Ð»ÑÐ½ÑƒÑ‚Ð¸ Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ—  ðŸŒŽ https://t.me/Yak_ty",
            'reply_markup' => json_encode($this->keyboards['default'])
        ]);
    }

    /**
     * ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð²Ð²Ð¾Ð´Ð° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ "Ð†ÑÑ‚Ð¾Ñ€Ñ–Ñ—"
     */
    function cmd_istorii(){

        $conn = new mysqli("localhost", "root", "mysql", "news");
        if($conn->connect_error){
            die("ÐžÑˆÐ¸Ð±ÐºÐ°: " . $conn->connect_error);
        }
        $sql = "SELECT * FROM newone";
        if($result = $conn->query($sql)){
            foreach($result as $row){
                $text = $row["description"];
            }
            foreach($result as $row){
                $chat_idd = $row["title"];
            }

        } else{
            echo "ÐžÑˆÐ¸Ð±ÐºÐ°: " . $conn->error;
        }
        $conn->close();
        if ($chat_idd == $this->result["message"]["from"]["id"]){
            $this->api->sendMessage( $text);
        }else{
            $this->api->sendMessage( "Ð£ Ð’Ð°Ñ Ð½ÐµÐ¼Ð°Ñ” Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ð¹");
        }
    }

    /**
     * ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð²Ð²Ð¾Ð´Ð° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ "ÑÐº Ñ†Ðµ Ð¿Ñ€Ð°Ñ†ÑŽÑ”"
     */
    function cmd_howwork(){
        $this->api->sendMessage( "ÐÐ°Ð¿Ð¸ÑˆÑ–Ñ‚ÑŒ ÑÐ²Ð¾ÑŽ Ñ–ÑÑ‚Ð¾Ñ€Ñ–ÑŽ Ñ‚Ð° Ð²Ñ–Ð´Ð¿Ñ€Ð°Ð²Ñ‚Ðµ Ð½Ð°ÑˆÐ¾Ð¼Ñƒ Ð±Ð¾Ñ‚Ñƒ. ÐŸÑ–ÑÐ»Ñ Ð¼Ð¾Ð´ÐµÑ€Ð°Ñ†Ñ–Ñ— Ð²Ð°ÑˆÐ° Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ Ð±ÑƒÐ´Ðµ Ð¾Ð¿ÑƒÐ±Ð»Ñ–ÐºÐ¾Ð²Ð°Ð½Ð° Ñ‚ÑƒÑ‚ @Yak_ty Ð²Ñ–Ð´ Ñ–Ð¼ÐµÐ½Ñ– ÐºÐ°Ð½Ð°Ð»Ñƒ.
ÐÐµ Ð·Ð°Ð±ÑƒÐ´ÑŒÑ‚Ðµ Ð¿Ñ–Ð´Ð¿Ð¸ÑÐ°Ñ‚Ð¸ÑÑ Ð½Ð° ÐºÐ°Ð½Ð°Ð», Ñ‰Ð¾Ð± Ð½Ðµ Ð¿Ñ€Ð¾Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ð¸ Ñ–Ð½ÑˆÑ– Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ—." );
    }

    /**
     * ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð²Ð²Ð¾Ð´Ð° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ "ÐÐ¾Ð²Ð¾ÑÑ‚Ð¸" Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ ÑÐ¾ ÑÐ¿Ð¸ÑÐºÐ¾Ð¼ Ð½Ð¾Ð²Ð¾ÑÑ‚ÐµÐ¹ Ð¸Ð· RSS-Ð»ÐµÐ½Ñ‚Ñ‹
     */
    function cmd_pravila(){
        $this->api->sendMessage( "ðŸ”·  Ð Ð¾Ð·Ð¿Ð¾Ð²Ñ–Ð´Ð°Ð¹Ñ‚Ðµ Ð±ÐµÐ· Ð´ÑƒÐ¼ÐºÐ¸, Ñ‰Ð¾ Ð²Ð°ÑˆÐ° Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ â€œÐ·Ð°Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ°â€ Ñ‡Ð¸ â€œÐ½ÐµÐ²Ð°Ð¶Ð»Ð¸Ð²Ð°â€. Ð’Ð°Ð¶Ð»Ð¸Ð²Ð° ÐºÐ¾Ð¶Ð½Ð° Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ, Ð´Ðµ Ð± Ð²Ð¸ Ñ– ÐºÐ¸Ð¼ Ð½Ðµ Ð±ÑƒÐ»Ð¸.
ðŸ”¶  ÐÐµ Ð²Ð²Ð°Ð¶Ð°Ð¹Ñ‚Ðµ Ð²Ð°Ñˆ Ð´Ð¾ÑÐ²Ñ–Ð´ â€œÐ½Ðµ Ñ‚Ð°ÐºÐ¸Ð¼ ÑÑ‚Ñ€Ð°ÑˆÐ½Ð¸Ð¼, ÑÐº Ð² Ñ–Ð½ÑˆÐ¸Ñ…â€. ÐœÐ¸ Ð½Ðµ Ð¿Ð¾Ñ€Ñ–Ð²Ð½ÑŽÑ”Ð¼Ð¾ Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ—, Ð¼Ð¸ Ð¿Ð¾Ð²Ð°Ð¶Ð°Ñ”Ð¼Ð¾ ÐºÐ¾Ð¶Ð½Ñƒ Ð¿Ð¾Ð´Ñ–ÑŽ, ÐµÐ¼Ð¾Ñ†Ñ–ÑŽ Ñ‡Ð¸ Ð´ÑƒÐ¼ÐºÑƒ. Ð”Ð»Ñ ÐºÐ¾Ð¶Ð½Ð¾Ð³Ð¾ â€œÑ‚ÑÐ¶ÐºÐ¸Ð¹ Ð´Ð¾ÑÐ²Ñ–Ð´â€ - Ñ†Ðµ Ñ‰Ð¾ÑÑŒ ÑÐ²Ð¾Ñ”.
ðŸ”·  ÐÐµ ÑÐ¾Ñ€Ð¾Ð¼Ñ‚ÐµÑÑŒ ÑÐ²Ð¾Ñ—Ñ… Ð¿Ð¾Ñ‡ÑƒÑ‚Ñ‚Ñ–Ð². Ð’Ð¸ Ð¼Ð°Ñ”Ñ‚Ðµ Ð½Ð° Ð½Ð¸Ñ… Ð¿Ñ€Ð°Ð²Ð¾.
ðŸ”¶  Ð”Ð¾Ð´Ð°Ð¹Ñ‚Ðµ Ð·Ð° Ð±Ð°Ð¶Ð°Ð½Ð½ÑÐ¼ (!) Ð² Ñ–ÑÑ‚Ð¾Ñ€Ñ–ÑŽ ÑÐ²Ð¾Ñ” Ñ–Ð¼'Ñ, Ð²Ñ–Ðº Ñ‚Ð° Ð½Ð°ÑÐµÐ»ÐµÐ½Ð¸Ð¹ Ð¿ÑƒÐ½ÐºÑ‚. ÐœÐ¸ Ð½Ðµ Ð·Ð±Ð¸Ñ€Ð°Ñ”Ð¼Ð¾ Ð½Ñ–ÑÐºÐ¸Ñ… Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½Ð¸Ñ… Ð´Ð°Ð½Ð¸Ñ…, Ð°Ð»Ðµ Ñ‚Ð°ÐºÐµ ÑƒÑ‚Ð¾Ñ‡Ð½ÐµÐ½Ð½Ñ Ð´Ð¾Ð¿Ð¾Ð¼Ð¾Ð¶Ðµ Ñ‡Ð¸Ñ‚Ð°Ñ‡ÐµÐ²Ñ– ÐºÑ€Ð°Ñ‰Ðµ Ð·Ñ€Ð¾Ð·ÑƒÐ¼Ñ–Ñ‚Ð¸ Ð²Ð°Ñ. 
ðŸ”·  Ð£Ð½Ð¸ÐºÐ°Ð¹Ñ‚Ðµ ÐºÑ€Ð¸Ñ‚Ð¸ÐºÐ¸ Ð½Ð°ÑˆÐ¸Ñ… Ð·Ð°Ñ…Ð¸ÑÐ½Ð¸ÐºÑ–Ð², Ð²Ð¾Ð»Ð¾Ð½Ñ‚ÐµÑ€Ñ–Ð², Ð²Ð»Ð°Ð´Ð¸. Ð—Ð°Ñ€Ð°Ð· Ð¼Ð¸ Ñ”Ð´Ð¸Ð½Ñ– Ñ‚Ð° Ð¿Ñ–Ð´Ñ‚Ñ€Ð¸Ð¼ÑƒÑ”Ð¼Ð¾ Ð¾Ð´Ð½Ðµ Ð¾Ð´Ð½Ð¾Ð³Ð¾.
ðŸ”¶  ÐœÐ¸ Ð·Ð°Ð»Ð¸ÑˆÐ°Ñ”Ð¼Ð¾ Ð·Ð° ÑÐ¾Ð±Ð¾ÑŽ Ð¿Ñ€Ð°Ð²Ð¾ Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÐ²Ð°Ñ‚Ð¸ Ð²Ð°Ñˆ Ñ‚ÐµÐºÑÑ‚ Ñƒ Ñ€Ñ–Ð·Ð½Ð¸Ñ… ÑÐ¾Ñ†Ñ–Ð°Ð»ÑŒÐ½Ð¸Ñ… Ð¼ÐµÑ€ÐµÐ¶Ð°Ñ… Ñ‚Ð° Ð¿Ñ€Ð¾Ñ”ÐºÑ‚Ð°Ñ… (Ñƒ Ñ‚Ð¾Ð¼Ñƒ Ð²Ð¸Ð³Ð»ÑÐ´Ñ–, Ð² ÑÐºÐ¾Ð¼Ñƒ Ð²Ñ–Ð½ Ð¾Ð¿ÑƒÐ±Ð»Ñ–ÐºÐ¾Ð²Ð°Ð½Ð¸Ð¹ Ð½Ð° ÐºÐ°Ð½Ð°Ð»Ñ–).

" );
    }

    /**
     * Ð§Ð¸Ñ‚Ð°Ñ‚Ð¸ Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ—
     */
    function cmd_readhistory(){
        $this->api->sendMessage( "https://t.me/Yak_ty" );
    }

    /**
     *
     */
    function cmd_podilutus(){
        $this->api->sendMessage( "Ð¯ Ð’Ð°Ñ ÑƒÐ²Ð°Ð¶Ð½Ð¾ ÑÐ»ÑƒÑ…Ð°ÑŽ, Ð¿Ð¾Ð´Ñ–Ð»Ñ–Ñ‚ÑŒÑÑ ÑÐ²Ð¾Ñ”ÑŽ Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ”ÑŽ" );
    }

    /**
     * ÐžÑ‚Ð²ÐµÑ‚ Ð½Ð° Ð²Ð²Ð¾Ð´, Ð½Ðµ Ñ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ð½Ð½Ñ‹Ð¹ ÐºÐ°Ðº ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°
     */
     function cmd_default(){
         $chat_idd = $this->result["message"]["from"]["id"];
         $text = $this->result["message"]["text"];
         $name = $this->result["message"]["from"]["first_name"];

         if( stripos( $text, "" ) !== true ){
             $this->api->sendMessage([
                 'text'=>"Ð’Ð¸ Ñ‚Ð°ÐºÐ¾Ð¶ Ð´Ð°Ñ”Ñ‚Ðµ Ð·Ð³Ð¾Ð´Ñƒ Ð½Ð° Ð¾Ð±Ñ€Ð¾Ð±ÐºÑƒ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½Ð¸Ñ… Ð´Ð°Ð½Ð¸Ñ…?",
                 'reply_markup' => json_encode( [
                     'inline_keyboard'=> $this->keyboards['inline1']
                 ] )
             ]);

             $conn1 = mysqli_connect("localhost", "root", "mysql", "infodb");
             $sql1 = "INSERT INTO infotable (title,description,detailtext) VALUES
            ('$chat_idd','$text','$name')";
             mysqli_query($conn1, $sql1);
         }else {


         }
    }

    /**
     * ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð²Ð²Ð¾Ð´Ð° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ "Ð˜Ð½Ð»Ð°Ð¹Ð½" Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ñ ÐºÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€Ð¾Ð¹, Ð¿Ñ€Ð¸ÐºÑ€ÐµÐ¿ÐµÐ»Ð½Ð½Ð¾Ð¹ Ðº ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÑŽ.
     */
    function cmd_inlinemenu(){
        $this->api->sendMessage([
            'text'=>"ÐÐ°Ð¿Ð¸ÑˆÑ–Ñ‚ÑŒ Ð½Ð°Ð¼ ÑÐ²Ð¾ÑŽ Ñ–ÑÑ‚Ð¾Ñ€Ñ–ÑŽ.",
        ]);
    }

    // ÐŸÑ€Ð¾ÑÑ‚Ð¾Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚ Ð½Ð° Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ðµ ÐºÐ½Ð¾Ð¿ÐºÐ¸
    // Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸ÐµÐ¼ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¸ ÐºÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€Ñ‹ Ð¿Ð¾Ð´ Ð½Ð¸Ð¼
    public function callback_act1($query)
    {
        $this->api->sendMessage([
            'text'=>"Ð”ÑÐºÑƒÑ”Ð¼Ð¾, Ð²Ð°ÑˆÐ° Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ Ð¿Ñ–ÑÐ»Ñ Ð¼Ð¾Ð´ÐµÑ€Ð°Ñ†Ñ–Ñ— Ð·'ÑÐ²Ð¸Ñ‚ÑŒÑÑ Ð² Ð½Ð°ÑˆÑ–Ð¹ Ð³Ñ€ÑƒÐ¿Ñ– https://t.me/Yak_ty"
            ] );


$conn = new mysqli("localhost", "root", "mysql", "infodb");
if($conn->connect_error){
    die("ÐžÑˆÐ¸Ð±ÐºÐ°: " . $conn->connect_error);
}
$sql = "SELECT * FROM infotable";
if($result = $conn->query($sql)){
        foreach($result as $row){
            $text = $row["detailtext"];
        }
        foreach($result as $row){
        $chat_idd = $row["title"];
        }
        foreach($result as $row){
            $name = $row["description"];
        }
        } else{
            echo "ÐžÑˆÐ¸Ð±ÐºÐ°: " . $conn->error;
        }
        $conn->close();
        $conn = mysqli_connect("localhost", "root", "mysql", "news");
        $sql = "INSERT INTO newone (detailtext, title, description) VALUES
            ('$text', '$chat_idd', '$name')";
        mysqli_query($conn, $sql);
        mysqli_close($conn);
    }



    // ÐžÑ‚Ð²ÐµÑ‚ Ð½Ð° Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ðµ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¾Ð¹ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð²
    function callback_act2( $query ){
        $text = "Ð’Ð¸Ð¿Ñ€Ð°Ð²Ñ‚Ðµ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÐµÐ½Ð½Ñ, Ñ‚Ð° Ð²Ñ–Ð´Ð¿Ñ€Ð°Ð²Ñ‚Ðµ Ñ‰Ðµ Ñ€Ð°Ð· Ð´Ð¾ Ð±Ð¾Ñ‚Ð°";
        $this->callbackAnswer( $text, $this->keyboards['close'] );
    }


    // ÐžÑ‚Ð²ÐµÑ‚ Ð½Ð° Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ðµ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð²ÑÐ¿Ð»Ñ‹Ð²Ð°ÑŽÑ‰Ð¸Ð¼ Ð¾ÐºÐ½Ð¾Ð¼
    function callback_act3( $query ){
        $this->api->answerCallbackQuery( [
            'callback_query_id' => $this->result['callback_query']["id"],
            'text' => "Ð’Ñ‹ Ð½Ð°Ð¶Ð°Ð»Ð¸ ÐºÐ½Ð¾Ð¿ÐºÑƒ \"Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ 3\"",
            'show_alert' => true
        ] );
    }

    // ÐžÑ‚Ð²ÐµÑ‚ Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÑƒ "ÐÐ°Ð·Ð°Ð´" Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½ÑƒÑŽ ÐºÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€Ñƒ
    function callback_back(){
        $text = "Ð’Ð¸Ð±ÐµÑ€Ñ–Ñ‚ÑŒ Ð´Ñ–ÑŽ";
        $this->callbackAnswer( $text, $this->keyboards['inline'] );
    }

    // ÐžÑ‚Ð²ÐµÑ‚ Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÑƒ "Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ"
    function callback_logout(){
        $this->api->answerCallbackQuery( $this->result['callback_query']["id"] );
        $this->api->deleteMessage( $this->result['callback_query']['message']['message_id'] );
    }

}

?>
